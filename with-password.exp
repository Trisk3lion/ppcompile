#!/usr/bin/expect

# exp_internal 1  # debug

set cmd [lrange $argv 0 end]
# expand list
spawn {*}$cmd

expect {
    "password: " {
        set passwd $::env(PPCOMPILE_PASSWORD)
        send "${passwd}\r"
    }
    # Password is not needed, for e.g. public key authentication
    eof
}

# interact

# catch and propagate exit code
catch wait result
exit [lindex $result 3]
